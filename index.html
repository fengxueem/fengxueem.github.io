<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>COVID-19</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <!-- add echarts -->
    <script src="echarts.min.js"></script>
    <script src="index.js"></script>
</head>
<body>
    <!-- echarts dom -->
    <div id="covid_daily" style="width:100%;"></div>
    <div id="benford_law" style="width:100%;"></div>
    <div id="pain_surgery" style="width:100%;"></div>
    <script type="text/javascript">
        var start_date = new Date(2020, 0, 20);
        var pain_start_date = new Date(2020, 1, 24);
        var date_list = getDiffDate(start_date, new Date());
        var pain_date_list = getDiffDate(pain_start_date, new Date());
        var daily_diag = [
            5, 44, 62, 154, 264, 365, 398,
            480, 619, 705, 762, 755, 669, 726,
            896, 731, 707, 696, 558, 509, 444,
            381, 377, 312, 267, 221, 166, 115,
            79, 56, 45, 258, 31, 18, 11,
            9, 5
        ];
        var daily_death = [
            null, 0, 0, 0, 1, 2, 0,
            2, 1, 1, 1, 1, 0, 1,
            0, 0, 3, 4, 5, 8, 6,
            5, 3, 12, 5, 4, 3, 5,
            5, 4, 6, 3, 3, 1, 1,
            3, 0
        ];
        var pain_level = [
            1, 10, 10
        ];
        // set charts height automatically
        chartHeight = 0.8 * getWindowHeight();
        document.getElementById("covid_daily").style.height= chartHeight +"px";
        document.getElementById("benford_law").style.height= chartHeight +"px";
        document.getElementById("pain_surgery").style.height= chartHeight +"px";
        // init echarts
        var covidDaily = echarts.init(document.getElementById('covid_daily'));
        var benfordLaw = echarts.init(document.getElementById('benford_law'));
        var painDaily = echarts.init(document.getElementById('pain_surgery'));
        // chart data
        var covidOption = {
            title: {
                text: '每日省外新增确诊，新增病死(不含港澳台)'
            },
            tooltip: {},
            legend: {
                data:['新增确诊', '新增病死']
            },
            xAxis: {
                data: date_list
            },
            yAxis: {},
            dataZoom: [
                // x axis data slider
                {   
                    type: 'slider',
                    start: 0,
                    end: 60
                },
                // x axis data inside slider
                {   
                    type: 'inside', 
                    start: 0,     
                    end: 60
                }
            ],
            series: [
                {
                    name: '新增确诊',
                    type: 'bar',
                    data: daily_diag
                },
                {
                    name: '新增病死',
                    type: 'bar',
                    data: daily_death
                }
            ]
        };
        var benfordOption = {
            title: {
                text: '每日新增确诊本福特验证'
            },
            tooltip: {},
            legend: {
                data:['本福特值', '实际结果']
            },
            xAxis: {
                data: [
                    "1","2","3","4","5","6","7",
                    "8","9"
                ]
            },
            yAxis: {},
            series: [
                {
                    name: '本福特值',
                    type: 'line',
                    data: [
                        0.301, 0.176, 0.125, 0.097, 0.079, 0.067, 0.058,
                        0.051, 0.046
                    ]
                },
                {
                    name: '实际结果',
                    type: 'bar',
                    data: histBenford(daily_diag)
                }
            ]
        };
        var painOption = {
            title: {
                text: '自助记录'
            },
            tooltip: {},
            legend: {
                data:['主观疼痛']
            },
            xAxis: {
                data: pain_date_list
            },
            yAxis: {},
            series: [
                {
                    name: '主观疼痛',
                    type: 'line',
                    data: pain_level
                }
            ]
        };
        // bind data with echarts
        covidDaily.setOption(covidOption);
        benfordLaw.setOption(benfordOption);
        painDaily.setOption(painOption);
        window.addEventListener("resize",function(){
            document.getElementById("covid_daily").style.height= chartHeight +"px";
            document.getElementById("benford_law").style.height= chartHeight +"px";
            document.getElementById("pain_surgery").style.height= chartHeight +"px";
            covidDaily.resize();
            benfordLaw.resize();
            painDaily.resize();
        });
    </script>
</body>
</html>